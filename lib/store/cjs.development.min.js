Object.defineProperty(exports,"__esModule",{value:!0});var e=require("fiddlehead");let t=e=>{if(e!==Object(e))throw new TypeError("The store data must be a reference type.");let t=new Set;return{get data(){return e},setData(r){r(e),t.forEach((t=>{t(e)}))},subscribe:t.add.bind(t),unsubscribe:t.delete.bind(t)}},r=(t,r,s)=>{let a=e.useState(r(t.data));return e.useEffect((()=>{let e=e=>{void 0===s?a[1](r(e)):a[1]((t=>{let a=r(e);return s(t,a)?t:a}))};return t.subscribe(e),()=>{t.unsubscribe(e)}}),[t]),a[0]},s=(t,r)=>e.useCallback((e=>{t.setData((t=>{r(e,t)}))}),[t]),a=new WeakMap,o=t=>{let r,s=e.useTreeId(),o=a.get(s);if(void 0!==o&&(r=o.get(t)),void 0===r)throw new ReferenceError("Attempting to access an uninitialized store.");return r};exports.createStore=t,exports.useGlobalStoreRead=r,exports.useGlobalStoreWrite=s,exports.useStoreInit=(r,s)=>{if(r!==Object(r))throw new TypeError("The store scope must be a reference type.");let o=e.useTreeId(),n=a.get(o);void 0===n&&(n=new WeakMap,a.set(o,n)),n.has(r)?console.warn("The store already has been initialized."):n.set(r,t(s))},exports.useStoreRead=(e,t,s)=>{let a=o(e);return r(a,t,s)},exports.useStoreWrite=(e,t)=>{let r=o(e);return s(r,t)};
