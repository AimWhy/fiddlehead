import{useState as e,useEffect as t,useTreeId as r}from"fiddlehead";let n=e=>{if(null==e||e.constructor!==Object)throw new TypeError("The store's data must be a plain object.");let t=e,r=new Set;return{get data(){return t},setData(e){e(t),r.forEach((e=>{e(t)}))},subscribe:r.add.bind(r),unsubscribe:r.delete.bind(r)}},a=(r,n,a)=>{let o=e(n(r.data));return t((()=>{let e=e=>{void 0===a?o[1](n(e)):o[1]((t=>{let r=n(e);return a(t,r)?t:r}))};return r.subscribe(e),()=>{r.unsubscribe(e)}}),[r,n,a]),o[0]},o=(e,t)=>r=>{e.setData((e=>{t(e,r)}))},i=new WeakMap,l=(e,t)=>{let a=r(),o=i.get(a);void 0===o&&(o=new WeakMap,i.set(a,o)),o.has(e)||o.set(e,n(t))},u=e=>{let t,n=r(),a=i.get(n);if(void 0!==a&&(t=a.get(e)),void 0===t)throw new ReferenceError("Cannot access a store before initialization.");return t},s=(e,t,r)=>{let n=u(e);return a(n,t,r)},d=(e,t)=>{let r=u(e);return o(r,t)};export{n as createStore,a as useGlobalStoreRead,o as useGlobalStoreWrite,l as useStoreInit,s as useStoreRead,d as useStoreWrite};
