import{useState as t,useEffect as e}from"hook";let r=t=>{if(null==t||t.constructor!==Object)throw new Error("Store data must be a plain object");let e=t,r=new Set;return{get data(){return e},setData(t){t(e),r.forEach((t=>{t(e)}))},subscribe:r.add.bind(r),unsubscribe:r.delete.bind(r)}},n=(r,n,o)=>{let u=t(n(r.data));return e((()=>{let t=t=>{void 0===o?u[1](n(t)):u[1]((e=>{let r=n(t);return o(e,r)?e:r}))};return r.subscribe(t),()=>{r.unsubscribe(t)}}),[r,n,o]),u[0]},o=(t,e)=>r=>{t.setData((t=>{e(t,r)}))};export{r as createStore,n as useReadableStore,o as useWritableStore};
