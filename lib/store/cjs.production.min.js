Object.defineProperty(exports,"__esModule",{value:!0});var e=require("fiddlehead");let r=e=>{if(e!==Object(e))throw new TypeError("The store data must be a reference type.");let r=new Set;return{get data(){return e},setData(t){t(e),r.forEach((r=>{r(e)}))},subscribe:r.add.bind(r),unsubscribe:r.delete.bind(r)}},t=(r,t,o)=>{let n=e.useState(t(r.data));return e.useEffect((()=>{let e=e=>{void 0===o?n[1](t(e)):n[1]((r=>{let n=t(e);return o(r,n)?r:n}))};return r.subscribe(e),()=>{r.unsubscribe(e)}}),[r]),n[0]},o=(r,t)=>e.useCallback((e=>{r.setData((r=>{t(e,r)}))}),[r]),n=new WeakMap,s=r=>{let t,o=e.useTreeId(),s=n.get(o);if(void 0!==s&&(t=s.get(r)),void 0===t)throw new ReferenceError("Attempting to access an uninitialized store.");return t};exports.createStore=r,exports.useGlobalStoreRead=t,exports.useGlobalStoreWrite=o,exports.useStoreInit=(t,o)=>{if(t!==Object(t))throw new TypeError("The store scope must be a reference type.");let s=e.useTreeId(),a=n.get(s);void 0===a&&(a=new WeakMap,n.set(s,a)),a.has(t)||a.set(t,r(o))},exports.useStoreRead=(e,r,o)=>{let n=s(e);return t(n,r,o)},exports.useStoreWrite=(e,r)=>{let t=s(e);return o(t,r)};
